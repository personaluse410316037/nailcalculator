<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>美甲收費計算機</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center; /* 內容置中 */
      justify-content: center;
      min-height: 100vh;
      background-color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }
    h1 {
      font-size: 2.5em; /* 標題文字放大 */
      color: #333;
    }
    label, input, button {
      font-size: 1.5em; /* 選項和按鈕文字放大 */
      margin: 10px 0;
    }
    input[type="number"] {
      width: 60px;
      font-size: 1.5em;
      padding: 5px;
    }
    button {
      padding: 10px 20px;
      border-radius: 5px;
      background-color: #ff6f61;
      color: white;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover {
      background-color: #e55a50;
    }
    .delete-btn {
      background-color: #e55a50;
      font-size: 1.2em;
      padding: 5px 10px;
    }
    .delete-btn:hover {
      background-color: #c7463e;
    }
    .result-container {
      text-align: left;
      width: 100%;
      max-width: 500px;
    }
    #result {
      font-size: 2.2em; /* 總計文字放大 */
      font-weight: bold; /* 總計加粗 */
      color: #333;
    }
    #explanation {
      font-size: 1.8em; /* 收費明細文字放大 */
      color: #333;
    }
    .detail-item {
      display: block;
      text-align: right; /* 細項和數字置右 */
    }
    .note {
      font-size: 0.8em; /* 括號內容小一號 */
      display: block;
      text-align: right; /* 括號內容置右 */
    }
    .container {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      width: 90%;
      max-width: 500px;
    }
    hr {
      border: 1px solid #ccc;
      margin: 20px 0;
    }
    .section-title {
      font-size: 1.6em;
      color: #555;
      margin:  Subscriptions: 10px 0;
    }
    .sub-section {
      margin-left: 20px;
      display: none; /* 初始隱藏功能項 */
    }
    table {
      width: 100%;
      max-width: 500px;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
      font-size: 1.4em;
    }
    th {
      background-color: #f5f5f5;
    }
    .record-detail {
      white-space: pre-wrap; /* 保留換行 */
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>美甲收費計算機</h1>
    
    <div class="section-title">選擇服務類別</div>
    <label><input type="checkbox" id="hand" onchange="toggleSection('hand')"> 手部服務</label><br>
    <div id="handSection" class="sub-section">
      <div class="section-title">手部功能項（單選）</div>
      <label><input type="radio" name="handService" value="softGel"> Soft Gel</label><br>
      <label><input type="radio" name="handService" value="hardGel"> Hard Gel</label><br>
      <label><input type="radio" name="handService" value="wetManicure" onchange="togglePureRemove('hand')"> 無 Gel 浸水修手</label><br>
      <label><input type="radio" name="handService" value="dryManicure" onchange="togglePureRemove('hand')"> 無浸水修手/卸甲後護理</label><br>
      <label id="handPureRemoveLabel" style="display: none;"><input type="checkbox" id="handPureRemove"> 純卸甲 (+$80)</label><br>
      <div class="section-title">Soft Gel 選項</div>
      <label><input type="checkbox" id="handSoftGelRemove"> 需卸甲 (+$50)</label>
      <label><input type="checkbox" id="handSoftGelFrench"> 法式 (+$50)</label><br>
      <div class="section-title">Hard Gel 選項</div>
      <label><input type="checkbox" id="handHardGelRemove"> 需卸甲 (+$30)</label>
      <label><input type="checkbox" id="handHardGelFrench"> 法式 (+$50)</label><br>
      <div class="section-title">Gel 款式</div>
      <label>牆上/新色版/閃粉 (+$50): <input type="number" id="handStyleGlitter" min="0" max="10" value="0"></label><br>
      <label>貓眼 (+$80): <input type="number" id="handStyleCatEye" min="0" max="10" value="0"></label><br>
      <label>多一隻色（跳色）(+$30): <input type="number" id="handStyleExtraColor" min="0" max="10" value="0"></label><br>
      <label>捽粉 (+$100): <input type="number" id="handStylePowder" min="0" max="10" value="0"></label><br>
      <label>有底色捽粉 (+$100): <input type="number" id="handStylePowderBase" min="0" max="10" value="0"></label>
      <label><input type="radio" name="handPowderBaseCost" value="50"> +$50</label>
      <label><input type="radio" name="handPowderBaseCost" value="30"> +$30</label><br>
      <label>單色漸變 (+$80): <input type="number" id="handStyleGradient" min="0" max="10" value="0"></label><br>
      <label>簡單畫花/貼紙 (每隻 +$10): <input type="number" id="handStyleDecoration" min="0" max="10" value="0"></label><br>
      <label>貼石 (每粒 +$3): <input type="number" id="handStyleStone" min="0" max="10" value="0"></label><br>
      <div class="section-title">額外選項</div>
      <label>做完 Gel 浸手修手 (+$100): <input type="number" id="handExtraSoak" min="0" max="10" value="0"></label><br>
      <label>延長 (每隻 +$10, 僅限 Hard Gel): <input type="number" id="handExtraExtend" min="0" max="10" value="0"></label><br>
      <div class="section-title">Gel 補甲</div>
      <label><input type="radio" name="handRepair" value="free"> 7 日內免費</label>
      <label><input type="radio" name="handRepair" value="inStore"> 超過 7 日 (本店 $30/隻)</label>
      <label><input type="radio" name="handRepair" value="outStore"> 超過 7 日 (非本店 $50/隻)</label>
      <label>補甲數量: <input type="number" id="handRepairQty" min="0" max="10" value="0"></label><br>
    </div>

    <label><input type="checkbox" id="foot" onchange="toggleSection('foot')"> 腳部服務</label><br>
    <div id="footSection" class="sub-section">
      <div class="section-title">腳部功能項（單選）</div>
      <label><input type="radio" name="footService" value="softGel"> Soft Gel</label><br>
      <label><input type="radio" name="footService" value="hardGel"> Hard Gel</label><br>
      <label><input type="radio" name="footService" value="wetPedicure" onchange="togglePureRemove('foot')"> 無 Gel 浸水修腳</label><br>
      <label><input type="radio" name="footService" value="dryPedicure" onchange="togglePureRemove('foot')"> 無浸水修腳/卸甲後護理</label><br>
      <label id="footPureRemoveLabel" style="display: none;"><input type="checkbox" id="footPureRemove"> 純卸甲 (+$100)</label><br>
      <div class="section-title">Soft Gel 選項</div>
      <label><input type="checkbox" id="footSoftGelRemove"> 需卸甲 (+$50)</label><br>
      <label><input type="checkbox" id="footSoftGelFrench"> 法式 (+$50)</label><br>
      <div class="section-title">Hard Gel 選項</div>
      <label><input type="checkbox" id="footHardGelFrench"> 法式 (+$50)</label><br>
      <div class="section-title">Gel 款式</div>
      <label>牆上/新色版/閃粉 (+$50): <input type="number" id="footStyleGlitter" min="0" max="10" value="0"></label><br>
      <label>貓眼 (+$80): <input type="number" id="footStyleCatEye" min="0" max="10" value="0"></label><br>
      <label>多一隻色（跳色）(+$30): <input type="number" id="footStyleExtraColor" min="0" max="10" value="0"></label><br>
      <label>捽粉 (+$100): <input type="number" id="footStylePowder" min="0" max="10" value="0"></label><br>
      <label>有底色捽粉 (+$100): <input type="number" id="footStylePowderBase" min="0" max="10" value="0"></label>
      <label><input type="radio" name="footPowderBaseCost" value="50"> +$50</label>
      <label><input type="radio" name="footPowderBaseCost" value="30"> +$30</label><br>
      <label>單色漸變 (+$80): <input type="number" id="footStyleGradient" min="0" max="10" value="0"></label><br>
      <label>簡單畫花/貼紙 (每隻 +$10): <input type="number" id="footStyleDecoration" min="0" max="10" value="0"></label><br>
      <label>貼石 (每粒 +$3): <input type="number" id="footStyleStone" min="0" max="10" value="0"></label><br>
      <div class="section-title">額外選項</div>
      <label>做完 Gel 浸腳修腳 (+$100): <input type="number" id="footExtraSoak" min="0" max="10" value="0"></label><br>
      <label>延長 (每隻 +$10, 僅限 Hard Gel): <input type="number" id="footExtraExtend" min="0" max="10" value="0"></label><br>
      <div class="section-title">Gel 補甲</div>
      <label><input type="radio" name="footRepair" value="free"> 7 日內免費</label>
      <label><input type="radio" name="footRepair" value="inStore"> 超過 7 日 (本店 $30/隻)</label>
      <label><input type="radio" name="footRepair" value="outStore"> 超過 7 日 (非本店 $50/隻)</label>
      <label>補甲數量: <input type="number" id="footRepairQty" min="0" max="10" value="0"></label><br>
    </div>

    <label><input type="checkbox" id="eyelash" onchange="toggleSection('eyelash')"> 眼睫毛服務</label><br>
    <div id="eyelashSection" class="sub-section">
      <div class="section-title">眼睫毛功能項（單選）</div>
      <label><input type="radio" name="eyelashService" value="natural"> 自然款 ($368)</label><br>
      <label><input type="radio" name="eyelashService" value="dense"> 濃密款 ($468)</label><br>
      <label><input type="radio" name="eyelashService" value="special"> 特殊款 ($568)</label><br>
      <label><input type="radio" name="eyelashService" value="package"> 套票補睫 (免費，需簿仔簽名)</label><br>
      <label><input type="radio" name="eyelashService" value="cashRepair"> 現金補睫 ($298)</label><br>
      <label><input type="radio" name="eyelashService" value="remove"> 純卸睫 ($150)</label><br>
      <label><input type="radio" name="eyelashService" value="tenDay"> 10 日補睫 (免費)</label><br>
    </div>

    <hr> <!-- 分隔線 -->

    <button onclick="calculate()">計算費用</button>
    <button onclick="addRecord()">加入記錄</button>
    <div class="result-container">
      <p id="result">總計: $0</p>
      <p id="explanation">收費明細：請選擇服務</p>
    </div>
  </div>

  <div class="section-title">記錄</div>
  <table id="recordTable">
    <thead>
      <tr>
        <th>日期</th>
        <th>收費明細</th>
        <th>操作</th>
      </tr>
    </thead>
    <tbody id="recordBody"></tbody>
  </table>

  <script>
    // 初始化記錄（從 localStorage 載入）
    let records = JSON.parse(localStorage.getItem('nailRecords')) || [];
    renderRecords();

    function toggleSection(section) {
      const handSection = document.getElementById('handSection');
      const footSection = document.getElementById('footSection');
      const eyelashSection = document.getElementById('eyelashSection');
      handSection.style.display = document.getElementById('hand').checked ? 'block' : 'none';
      footSection.style.display = document.getElementById('foot').checked ? 'block' : 'none';
      eyelashSection.style.display = document.getElementById('eyelash').checked ? 'block' : 'none';
      togglePureRemove('hand');
      togglePureRemove('foot');
    }

    function togglePureRemove(section) {
      const handPureRemoveLabel = document.getElementById('handPureRemoveLabel');
      const footPureRemoveLabel = document.getElementById('footPureRemoveLabel');
      if (section === 'hand') {
        const handService = document.querySelector('input[name="handService"]:checked');
        handPureRemoveLabel.style.display = handService && (handService.value === 'wetManicure' || handService.value === 'dryManicure') ? 'block' : 'none';
      } else if (section === 'foot') {
        const footService = document.querySelector('input[name="footService"]:checked');
        footPureRemoveLabel.style.display = footService && (footService.value === 'wetPedicure' || footService.value === 'dryPedicure') ? 'block' : 'none';
      }
    }

    function calculate() {
      let total = 0;
      let explanation = "收費明細：<br>";
      let addOnFees = [];
      let servicesSelected = false;

      // 手部服務
      if (document.getElementById('hand').checked) {
        const handService = document.querySelector('input[name="handService"]:checked');
        if (handService) {
          servicesSelected = true;
          if (handService.value === 'softGel') {
            let softGelCost = document.getElementById('handSoftGelRemove').checked ? 200 : 150;
            if (document.getElementById('handSoftGelFrench').checked) {
              softGelCost = document.getElementById('handSoftGelRemove').checked ? 250 : 200;
            }
            total += softGelCost;
            explanation += `<span class="detail-item">手部 Soft Gel ${softGelCost === 250 ? '法式 (需卸甲)' : softGelCost === 200 && document.getElementById('handSoftGelFrench').checked ? '法式' : document.getElementById('handSoftGelRemove').checked ? '(需卸甲)' : ''} $${softGelCost}</span><br>`;
          } else if (handService.value === 'hardGel') {
            let hardGelCost = document.getElementById('handHardGelRemove').checked ? 218 : 188;
            if (document.getElementById('handHardGelFrench').checked) hardGelCost = 238;
            total += hardGelCost;
            explanation += `<span class="detail-item">手部 Hard Gel ${hardGelCost === 238 ? '法式' : document.getElementById('handHardGelRemove').checked ? '(需卸甲)' : ''} $${hardGelCost}</span><br>`;
          } else if (handService.value === 'wetManicure') {
            let cost = 80;
            if (document.getElementById('handPureRemove').checked) cost += 80;
            total += cost;
            explanation += `<span class="detail-item">手部 無 Gel 浸水修手 ${document.getElementById('handPureRemove').checked ? '(含純卸甲)' : ''} $${cost}</span><br>`;
          } else if (handService.value === 'dryManicure') {
            let cost = 80;
            if (document.getElementById('handPureRemove').checked) cost += 80;
            total += cost;
            explanation += `<span class="detail-item">手部 無浸水修手/卸甲後護理 ${document.getElementById('handPureRemove').checked ? '(含純卸甲)' : ''} $${cost}</span><br>`;
          }

          // Gel 款式
          let baseTotal = total;
          const glitterQty = parseInt(document.getElementById('handStyleGlitter').value) || 0;
          if (glitterQty > 0) addOnFees.push({ name: '手部 牆上/新色版/閃粉', fee: 50, qty: glitterQty });
          const catEyeQty = parseInt(document.getElementById('handStyleCatEye').value) || 0;
          if (catEyeQty > 0) addOnFees.push({ name: '手部 貓眼', fee: 80, qty: catEyeQty });
          const extraColorQty = parseInt(document.getElementById('handStyleExtraColor').value) || 0;
          if (extraColorQty > 0) addOnFees.push({ name: '手部 多一隻色（跳色）', fee: 30, qty: extraColorQty });
          const powderQty = parseInt(document.getElementById('handStylePowder').value) || 0;
          if (powderQty > 0) addOnFees.push({ name: '手部 捽粉', fee: 100, qty: powderQty });
          const powderBaseQty = parseInt(document.getElementById('handStylePowderBase').value) || 0;
          if (powderBaseQty > 0) {
            const powderBaseCost = document.querySelector('input[name="handPowderBaseCost"]:checked')?.value || 50;
            addOnFees.push({ name: `手部 有底色捽粉 (+$${powderBaseCost})`, fee: 100 + parseInt(powderBaseCost), qty: powderBaseQty });
          }
          const gradientQty = parseInt(document.getElementById('handStyleGradient').value) || 0;
          if (gradientQty > 0) addOnFees.push({ name: '手部 單色漸變', fee: 80, qty: gradientQty, note: '（雙色漸變有時也是 $80，需確認）' });
          const decorationQty = parseInt(document.getElementById('handStyleDecoration').value) || 0;
          if (decorationQty > 0) addOnFees.push({ name: '手部 簡單畫花/貼紙', fee: 10, qty: decorationQty });
          const stoneQty = parseInt(document.getElementById('handStyleStone').value) || 0;
          if (stoneQty > 0) addOnFees.push({ name: '手部 貼石', fee: 3, qty: stoneQty });

          // 額外選項
          const soakQty = parseInt(document.getElementById('handExtraSoak').value) || 0;
          if (soakQty > 0) addOnFees.push({ name: '手部 做完 Gel 浸手修手', fee: 100, qty: soakQty });
          const extendQty = parseInt(document.getElementById('handExtraExtend').value) || 0;
          if (extendQty > 0 && handService?.value === 'hardGel') addOnFees.push({ name: '手部 延長', fee: 10, qty: extendQty });

          // 補甲
          const repairType = document.querySelector('input[name="handRepair"]:checked')?.value;
          const repairQty = parseInt(document.getElementById('handRepairQty').value) || 0;
          if (repairType && repairQty > 0) {
            if (repairType === 'free') {
              explanation += `<span class="detail-item">手部 Gel 補甲 ${repairQty} × $0 (7 日內免費)</span><br>`;
            } else if (repairType === 'inStore') {
              addOnFees.push({ name: '手部 Gel 補甲 (本店)', fee: 30, qty: repairQty });
            } else if (repairType === 'outStore') {
              addOnFees.push({ name: '手部 Gel 補甲 (非本店)', fee: 50, qty: repairQty });
            }
          }
        }
      }

      // 腳部服務
      if (document.getElementById('foot').checked) {
        const footService = document.querySelector('input[name="footService"]:checked');
        if (footService) {
          servicesSelected = true;
          if (footService.value === 'softGel') {
            let softGelCost = document.getElementById('footSoftGelRemove').checked ? 238 : 188;
            if (document.getElementById('footSoftGelFrench').checked) softGelCost = document.getElementById('footSoftGelRemove').checked ? 250 : 200;
            total += softGelCost;
            explanation += `<span class="detail-item">腳部 Soft Gel ${softGelCost === 250 ? '法式 (需卸甲)' : softGelCost === 200 && document.getElementById('footSoftGelFrench').checked ? '法式' : document.getElementById('footSoftGelRemove').checked ? '(需卸甲)' : ''} $${softGelCost}</span><br>`;
          } else if (footService.value === 'hardGel') {
            let hardGelCost = 258;
            if (document.getElementById('footHardGelFrench').checked) hardGelCost = 238;
            total += hardGelCost;
            explanation += `<span class="detail-item">腳部 Hard Gel ${hardGelCost === 238 ? '法式' : ''} $${hardGelCost}</span><br>`;
          } else if (footService.value === 'wetPedicure') {
            let cost = 198;
            if (document.getElementById('footPureRemove').checked) cost += 100;
            total += cost;
            explanation += `<span class="detail-item">腳部 無 Gel 浸水修腳 ${document.getElementById('footPureRemove').checked ? '(含純卸甲)' : ''} $${cost}</span><br>`;
          } else if (footService.value === 'dryPedicure') {
            let cost = 120;
            if (document.getElementById('footPureRemove').checked) cost += 100;
            total += cost;
            explanation += `<span class="detail-item">腳部 無浸水修腳/卸甲後護理 ${document.getElementById('footPureRemove').checked ? '(含純卸甲)' : ''} $${cost}</span><br>`;
          }

          // Gel 款式
          const glitterQty = parseInt(document.getElementById('footStyleGlitter').value) || 0;
          if (glitterQty > 0) addOnFees.push({ name: '腳部 牆上/新色版/閃粉', fee: 50, qty: glitterQty });
          const catEyeQty = parseInt(document.getElementById('footStyleCatEye').value) || 0;
          if (catEyeQty > 0) addOnFees.push({ name: '腳部 貓眼', fee: 80, qty: catEyeQty });
          const extraColorQty = parseInt(document.getElementById('footStyleExtraColor').value) || 0;
          if (extraColorQty > 0) addOnFees.push({ name: '腳部 多一隻色（跳色）', fee: 30, qty: extraColorQty });
          const powderQty = parseInt(document.getElementById('footStylePowder').value) || 0;
          if (powderQty > 0) addOnFees.push({ name: '腳部 捽粉', fee: 100, qty: powderQty });
          const powderBaseQty = parseInt(document.getElementById('footStylePowderBase').value) || 0;
          if (powderBaseQty > 0) {
            const powderBaseCost = document.querySelector('input[name="footPowderBaseCost"]:checked')?.value || 50;
            addOnFees.push({ name: `腳部 有底色捽粉 (+$${powderBaseCost})`, fee: 100 + parseInt(powderBaseCost), qty: powderBaseQty });
          }
          const gradientQty = parseInt(document.getElementById('footStyleGradient').value) || 0;
          if (gradientQty > 0) addOnFees.push({ name: '腳部 單色漸變', fee: 80, qty: gradientQty, note: '（雙色漸變有時也是 $80，需確認）' });
          const decorationQty = parseInt(document.getElementById('footStyleDecoration').value) || 0;
          if (decorationQty > 0) addOnFees.push({ name: '腳部 簡單畫花/貼紙', fee: 10, qty: decorationQty });
          const stoneQty = parseInt(document.getElementById('footStyleStone').value) || 0;
          if (stoneQty > 0) addOnFees.push({ name: '腳部 貼石', fee: 3, qty: stoneQty });

          // 額外選項
          const soakQty = parseInt(document.getElementById('footExtraSoak').value) || 0;
          if (soakQty > 0) addOnFees.push({ name: '腳部 做完 Gel 浸腳修腳', fee: 100, qty: soakQty });
          const extendQty = parseInt(document.getElementById('footExtraExtend').value) || 0;
          if (extendQty > 0 && footService?.value === 'hardGel') addOnFees.push({ name: '腳部 延長', fee: 10, qty: extendQty });

          // 補甲
          const repairType = document.querySelector('input[name="footRepair"]:checked')?.value;
          const repairQty = parseInt(document.getElementById('footRepairQty').value) || 0;
          if (repairType && repairQty > 0) {
            if (repairType === 'free') {
              explanation += `<span class="detail-item">腳部 Gel 補甲 ${repairQty} × $0 (7 日內免費)</span><br>`;
            } else if (repairType === 'inStore') {
              addOnFees.push({ name: '腳部 Gel 補甲 (本店)', fee: 30, qty: repairQty });
            } else if (repairType === 'outStore') {
              addOnFees.push({ name: '腳部 Gel 補甲 (非本店)', fee: 50, qty: repairQty });
            }
          }
        }
      }

      // 眼睫毛服務
      if (document.getElementById('eyelash').checked) {
        const eyelashService = document.querySelector('input[name="eyelashService"]:checked');
        if (eyelashService) {
          servicesSelected = true;
          if (eyelashService.value === 'natural') {
            total += 368;
            explanation += `<span class="detail-item">眼睫毛 自然款 $368</span><br>`;
          } else if (eyelashService.value === 'dense') {
            total += 468;
            explanation += `<span class="detail-item">眼睫毛 濃密款 $468</span><br>`;
          } else if (eyelashService.value === 'special') {
            total += 568;
            explanation += `<span class="detail-item">眼睫毛 特殊款 $568</span><br>`;
          } else if (eyelashService.value === 'package') {
            explanation += `<span class="detail-item">眼睫毛 套票補睫 $0</span><br>`;
            explanation += `<span class="note">(需在簿仔簽名)</span><br>`;
          } else if (eyelashService.value === 'cashRepair') {
            total += 298;
            explanation += `<span class="detail-item">眼睫毛 現金補睫 $298</span><br>`;
          } else if (eyelashService.value === 'remove') {
            total += 150;
            explanation += `<span class="detail-item">眼睫毛 純卸睫 $150</span><br>`;
          } else if (eyelashService.value === 'tenDay') {
            explanation += `<span class="detail-item">眼睫毛 10 日補睫 $0</span><br>`;
          }
        }
      }

      // 如果沒有選擇任何服務
      if (!servicesSelected) {
        document.getElementById("result").innerText = "總計: $0";
        document.getElementById("explanation").innerHTML = "收費明細：請選擇至少一項服務";
        return;
      }

      // 確保總價不為負
      total = Math.max(0, total);

      // 更新顯示
      document.getElementById("result").innerText = `總計: $${total}`;
      document.getElementById("explanation").innerHTML = explanation;

      // 儲存當前計算結果
      window.currentResult = { total, explanation };
    }

    function addRecord() {
      if (!window.currentResult || !window.currentResult.explanation.includes("detail-item")) {
        alert("請先計算費用並選擇至少一項服務！");
        return;
      }

      // 獲取當前日期（香港時間）
      const now = new Date();
      const dateStr = now.toLocaleDateString('zh-HK', { year: 'numeric', month: '2-digit', day: '2-digit' });

      // 準備記錄數據
      const record = {
        date: dateStr,
        explanation: window.currentResult.explanation.replace(/<br>/g, '\n').replace(/<\/?span[^>]*>/g, '')
      };

      // 添加到本地記錄
      records.push(record);
      localStorage.setItem('nailRecords', JSON.stringify(records));
      renderRecords();
    }

    function renderRecords() {
      const tbody = document.getElementById("recordBody");
      tbody.innerHTML = "";

      records.forEach((record, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${record.date}</td>
          <td class="record-detail">${record.explanation.replace(/\n/g, '<br>')}</td>
          <td><button class="delete-btn" onclick="deleteRecord(${index})">刪除</button></td>
        `;
        tbody.appendChild(row);
      });
    }

    function deleteRecord(index) {
      if (confirm("確定要刪除這條記錄嗎？")) {
        if (confirm("請再次確認，刪除後無法恢復！")) {
          records.splice(index, 1);
          localStorage.setItem('nailRecords', JSON.stringify(records));
          renderRecords();
        }
      }
    }
  </script>
</body>
</html>
